<%= form_with(model: @stock, url: [@widget, @stock])  do |form| %>
  <div class="form-control">
    <%= form.label :tickr, class: "label" do %>
      <span class="label-text">Ticker</span>
    <% end %>
    <%= form.text_field :tickr, class: "input input-bordered w-full" %>
  </div>

  <div class="form-control">
    <%= form.label :amount, class: "label" do %>
      <span class="label-text">Amount of Shares</span>
    <% end %>
    <%= form.number_field :amount, class: "input input-bordered w-full" %>
  </div>

  <div class="form-control">
    <%= form.label :purchase_price, class: "label" do %>
      <span class="label-text">Average Purchase Price</span>
    <% end %>
    <%= form.number_field :purchase_price, step: 0.01, class: "input input-bordered w-full" %>
  </div>

  <div class="form-control mt-4">
    <%= form.submit "Submit", class: "btn btn-primary w-full" %>
  </div>
<% end %>


<ul>
  <% @stocks.each do |stock| %>
    <li>
      <strong>Ticker:</strong> <%= stock.tickr %>,
      <strong>Shares:</strong> <%= stock.amount %>,
      <strong>Purchase Price:</strong> <%= number_to_currency stock.purchase_price %>
      <strong>Total Value:</strong> <%= number_to_currency stock.purchase_price * stock.amount  %>
      <%= link_to "Delete", stock_path(stock),
                  data: { turbo_method: :delete, turbo_confirm: "Are you sure?" },
                  class: "bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-2 rounded leading-[3rem]" %>
    </li>
  <% end %>
</ul>

<% if Stock.exists? %>
  <div class="flex items-center justify-center bg-gray-50 mt-10">
    <div class="card bg-white w-96 shadow-lg rounded-lg overflow-hidden">
      <div class="card-body p-6">
        <div class="flex items-baseline justify-between">
            <h2 class="text-2xl font-bold text-gray-800">
              <%= number_to_currency @total_value %>
            </h2>
            <% if @percentage_change.positive? %>
              <span class="text-sm font-medium text-gray-500 bg-green-100 px-2 py-1 rounded">
                <%= @percentage_change %>%
              </span>
            <% else %>
              <span class="text-sm font-medium text-gray-500 bg-red-100 px-2 py-1 rounded">
                <%= @percentage_change %>%
              </span>
            <% end %>
        </div>
      </div>
    </div>
  </div>
<% end %>
